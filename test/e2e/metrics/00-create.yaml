---
apiVersion: v1
kind: Service
metadata:
  name: metrics
  namespace: image-scanner
spec:
  ports:
    - name: metrics
      port: 80
      protocol: TCP
      targetPort: metrics
  selector:
    control-plane: image-scanner
---
apiVersion: v1
kind: Pod
metadata:
  name: metrics-up
spec:
  restartPolicy: Never
  containers:
    - name: run
      image: docker.io/prom/prometheus
      command:
        - /bin/sh
        - -c
      args:
        - promtool query instant http://metrics.image-scanner.svc.cluster.local/metrics 'up'
